{"filter":false,"title":"orders_controller.rb","tooltip":"/NaganoCake/app/controllers/admin/orders_controller.rb","undoManager":{"mark":10,"position":10,"stack":[[{"start":{"row":10,"column":0},"end":{"row":12,"column":0},"action":"insert","lines":["    @total_subtotal = 0","    @postage = 800",""],"id":55,"ignore":true},{"start":{"row":24,"column":0},"end":{"row":28,"column":0},"action":"remove","lines":["  def subtotal_price","      price*1.1","  end","",""]}],[{"start":{"row":10,"column":0},"end":{"row":12,"column":0},"action":"remove","lines":["    @total_subtotal = 0","    @postage = 800",""],"id":56,"ignore":true},{"start":{"row":22,"column":0},"end":{"row":26,"column":0},"action":"insert","lines":["  def subtotal_price","      price*1.1","  end","",""]}],[{"start":{"row":31,"column":3},"end":{"row":32,"column":0},"action":"insert","lines":["",""],"id":57},{"start":{"row":32,"column":0},"end":{"row":33,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":33,"column":0},"end":{"row":63,"column":5},"action":"insert","lines":["class Admin::OrdersController < ApplicationController","  def index","      @orders = Order.all.order(created_at: :desc)","  end","  def show","    @order = Order.find(params[:id])","    @orders = Order.all","    @order_items = @order.order_details.all","    @total_subtotal = 0","    @postage = 800","  end","  def update","    @order = Order.find(params[:id])","    @order_details = OrderDetail.where(order_id: params[:id])","    if @order.update(order_params)","      @order_details.update_all(making_status: 1) if @order.status == \"payment_confirmation\"","      ## ①注文ステータスが「入金確認」とき、製作ステータスを全て「製作待ち」に更新する","    end","    redirect_to admin_order_path(@order)","  end","  private","  def order_params","    params.require(:order).permit(:status)","  end","end","","","","","","20:45"],"id":59}],[{"start":{"row":63,"column":4},"end":{"row":63,"column":5},"action":"remove","lines":["5"],"id":60},{"start":{"row":63,"column":3},"end":{"row":63,"column":4},"action":"remove","lines":["4"]},{"start":{"row":63,"column":2},"end":{"row":63,"column":3},"action":"remove","lines":[":"]},{"start":{"row":63,"column":1},"end":{"row":63,"column":2},"action":"remove","lines":["0"]},{"start":{"row":63,"column":0},"end":{"row":63,"column":1},"action":"remove","lines":["2"]},{"start":{"row":62,"column":0},"end":{"row":63,"column":0},"action":"remove","lines":["",""]},{"start":{"row":61,"column":0},"end":{"row":62,"column":0},"action":"remove","lines":["",""]},{"start":{"row":60,"column":0},"end":{"row":61,"column":0},"action":"remove","lines":["",""]},{"start":{"row":59,"column":0},"end":{"row":60,"column":0},"action":"remove","lines":["",""]},{"start":{"row":58,"column":0},"end":{"row":59,"column":0},"action":"remove","lines":["",""]},{"start":{"row":57,"column":3},"end":{"row":58,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":0,"column":0},"end":{"row":31,"column":3},"action":"remove","lines":["class Admin::OrdersController < ApplicationController","","  def index","      @orders = Order.all.order(created_at: :desc)","  end","","  def show","    @order = Order.find(params[:id])","    @orders = Order.all","    @order_items = @order.order_details.all","  end","","  def update","    @order = Order.find(params[:id])","    @order_details = OrderDetail.where(order_id: params[:id])","    if @order.update(order_params)","      @order_details.update_all(making_status: 1) if @order.status == \"payment_confirmation\"","      ## ①注文ステータスが「入金確認」とき、製作ステータスを全て「製作待ち」に更新する","    end","    redirect_to admin_order_path(@order)","  end","","  def subtotal_price","      price*1.1","  end","","  private","","  def order_params","    params.require(:order).permit(:status)","  end","end"],"id":61}],[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":62},{"start":{"row":0,"column":0},"end":{"row":1,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"insert","lines":["",""],"id":63,"ignore":true},{"start":{"row":5,"column":0},"end":{"row":6,"column":0},"action":"insert","lines":["",""]},{"start":{"row":10,"column":0},"end":{"row":12,"column":0},"action":"remove","lines":["    @total_subtotal = 0","    @postage = 800",""]},{"start":{"row":11,"column":0},"end":{"row":12,"column":0},"action":"insert","lines":["",""]},{"start":{"row":21,"column":0},"end":{"row":26,"column":0},"action":"insert","lines":["","  def subtotal_price","      price*1.1","  end","",""]},{"start":{"row":27,"column":0},"end":{"row":28,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":1,"column":0},"end":{"row":2,"column":0},"action":"remove","lines":["",""],"id":64,"ignore":true},{"start":{"row":4,"column":0},"end":{"row":5,"column":0},"action":"remove","lines":["",""]},{"start":{"row":8,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["    @total_subtotal = 0","    @postage = 800",""]},{"start":{"row":11,"column":0},"end":{"row":12,"column":0},"action":"remove","lines":["",""]},{"start":{"row":20,"column":0},"end":{"row":25,"column":0},"action":"remove","lines":["","  def subtotal_price","      price*1.1","  end","",""]},{"start":{"row":21,"column":0},"end":{"row":22,"column":0},"action":"remove","lines":["",""]},{"start":{"row":24,"column":3},"end":{"row":39,"column":0},"action":"insert","lines":["","","","","","","","","","","","","","","",""]}],[{"start":{"row":24,"column":3},"end":{"row":39,"column":0},"action":"remove","lines":["","","","","","","","","","","","","","","",""],"id":65,"ignore":true}],[{"start":{"row":24,"column":3},"end":{"row":39,"column":0},"action":"insert","lines":["","","","","","","","","","","","","","","",""],"id":66,"ignore":true}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":24,"column":3},"end":{"row":24,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1695815216498,"hash":"32a54358b246d16275b1e02ba2794c852d26b369"}